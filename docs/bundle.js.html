<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>bundle.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Bezier.html">Bezier</a></li><li><a href="Board.html">Board</a></li><li><a href="Bundle.html">Bundle</a><ul class='methods'><li data-type='method'><a href="Bundle.html#.fromZip">fromZip</a></li><li data-type='method'><a href="Bundle.html#.toZip">toZip</a></li><li data-type='method'><a href="Bundle.html#getPrimary">getPrimary</a></li><li data-type='method'><a href="Bundle.html#hasPrimary">hasPrimary</a></li><li data-type='method'><a href="Bundle.html#removePrimary">removePrimary</a></li><li data-type='method'><a href="Bundle.html#setPrimary">setPrimary</a></li><li data-type='method'><a href="Bundle.html#toZip">toZip</a></li></ul></li><li><a href="Bus.html">Bus</a><ul class='methods'><li data-type='method'><a href="Bus.html#getConnectorIdAt">getConnectorIdAt</a></li><li data-type='method'><a href="Bus.html#hasConnectorId">hasConnectorId</a></li><li data-type='method'><a href="Bus.html#removeConnectorId">removeConnectorId</a></li><li data-type='method'><a href="Bus.html#removeConnectorIdAt">removeConnectorIdAt</a></li><li data-type='method'><a href="Bus.html#setConnectorId">setConnectorId</a></li></ul></li><li><a href="ERC.html">ERC</a></li><li><a href="Geometry.html">Geometry</a></li><li><a href="Instance.html">Instance</a><ul class='methods'><li data-type='method'><a href="Instance.html#getLocalConnector">getLocalConnector</a></li><li data-type='method'><a href="Instance.html#getLocalConnectorAt">getLocalConnectorAt</a></li><li data-type='method'><a href="Instance.html#getProperty">getProperty</a></li><li data-type='method'><a href="Instance.html#getPropertyAt">getPropertyAt</a></li><li data-type='method'><a href="Instance.html#hasLocalConnector">hasLocalConnector</a></li><li data-type='method'><a href="Instance.html#hasProperty">hasProperty</a></li><li data-type='method'><a href="Instance.html#removeLocalConnector">removeLocalConnector</a></li><li data-type='method'><a href="Instance.html#removeLocalConnectorAt">removeLocalConnectorAt</a></li><li data-type='method'><a href="Instance.html#removeProperty">removeProperty</a></li><li data-type='method'><a href="Instance.html#removePropertyAt">removePropertyAt</a></li><li data-type='method'><a href="Instance.html#setLocalConnector">setLocalConnector</a></li><li data-type='method'><a href="Instance.html#setProperty">setProperty</a></li></ul></li><li><a href="InstanceConnector.html">InstanceConnector</a><ul class='methods'><li data-type='method'><a href="InstanceConnector.html#getConnectorReference">getConnectorReference</a></li><li data-type='method'><a href="InstanceConnector.html#getConnectorReferenceAt">getConnectorReferenceAt</a></li><li data-type='method'><a href="InstanceConnector.html#getLegDataPointAt">getLegDataPointAt</a></li><li data-type='method'><a href="InstanceConnector.html#hasConnectorReference">hasConnectorReference</a></li><li data-type='method'><a href="InstanceConnector.html#hasLegDataPoint">hasLegDataPoint</a></li><li data-type='method'><a href="InstanceConnector.html#removeConnectorReference">removeConnectorReference</a></li><li data-type='method'><a href="InstanceConnector.html#removeConnectorReferenceAt">removeConnectorReferenceAt</a></li><li data-type='method'><a href="InstanceConnector.html#removeLegDataPoint">removeLegDataPoint</a></li><li data-type='method'><a href="InstanceConnector.html#removeLegDataPointAt">removeLegDataPointAt</a></li><li data-type='method'><a href="InstanceConnector.html#setConnectorReference">setConnectorReference</a></li><li data-type='method'><a href="InstanceConnector.html#setLegDataPoint">setLegDataPoint</a></li></ul></li><li><a href="InstanceConnectorReference.html">InstanceConnectorReference</a></li><li><a href="InstanceViewSettings.html">InstanceViewSettings</a><ul class='methods'><li data-type='method'><a href="InstanceViewSettings.html#getConnector">getConnector</a></li><li data-type='method'><a href="InstanceViewSettings.html#getConnectorAt">getConnectorAt</a></li><li data-type='method'><a href="InstanceViewSettings.html#hasConnector">hasConnector</a></li><li data-type='method'><a href="InstanceViewSettings.html#removeConnector">removeConnector</a></li><li data-type='method'><a href="InstanceViewSettings.html#removeConnectorAt">removeConnectorAt</a></li><li data-type='method'><a href="InstanceViewSettings.html#setConnector">setConnector</a></li></ul></li><li><a href="LocalConnector.html">LocalConnector</a></li><li><a href="Part.html">Part</a><ul class='methods'><li data-type='method'><a href="Part.html#.fromFZP">fromFZP</a></li><li data-type='method'><a href="Part.html#.toFZP">toFZP</a></li><li data-type='method'><a href="Part.html#getBus">getBus</a></li><li data-type='method'><a href="Part.html#getBusAt">getBusAt</a></li><li data-type='method'><a href="Part.html#getConnector">getConnector</a></li><li data-type='method'><a href="Part.html#getConnectorAt">getConnectorAt</a></li><li data-type='method'><a href="Part.html#getProperty">getProperty</a></li><li data-type='method'><a href="Part.html#getPropertyAt">getPropertyAt</a></li><li data-type='method'><a href="Part.html#getSubpart">getSubpart</a></li><li data-type='method'><a href="Part.html#getSubpartAt">getSubpartAt</a></li><li data-type='method'><a href="Part.html#getTagAt">getTagAt</a></li><li data-type='method'><a href="Part.html#getViewSettings">getViewSettings</a></li><li data-type='method'><a href="Part.html#getViewSettingsAt">getViewSettingsAt</a></li><li data-type='method'><a href="Part.html#hasBus">hasBus</a></li><li data-type='method'><a href="Part.html#hasConnector">hasConnector</a></li><li data-type='method'><a href="Part.html#hasProperty">hasProperty</a></li><li data-type='method'><a href="Part.html#hasSubpart">hasSubpart</a></li><li data-type='method'><a href="Part.html#hasTag">hasTag</a></li><li data-type='method'><a href="Part.html#hasViewSettings">hasViewSettings</a></li><li data-type='method'><a href="Part.html#removeBus">removeBus</a></li><li data-type='method'><a href="Part.html#removeBusAt">removeBusAt</a></li><li data-type='method'><a href="Part.html#removeConnector">removeConnector</a></li><li data-type='method'><a href="Part.html#removeConnectorAt">removeConnectorAt</a></li><li data-type='method'><a href="Part.html#removeProperty">removeProperty</a></li><li data-type='method'><a href="Part.html#removePropertyAt">removePropertyAt</a></li><li data-type='method'><a href="Part.html#removeSubpart">removeSubpart</a></li><li data-type='method'><a href="Part.html#removeSubpartAt">removeSubpartAt</a></li><li data-type='method'><a href="Part.html#removeTag">removeTag</a></li><li data-type='method'><a href="Part.html#removeTagAt">removeTagAt</a></li><li data-type='method'><a href="Part.html#removeViewSettings">removeViewSettings</a></li><li data-type='method'><a href="Part.html#removeViewSettingsAt">removeViewSettingsAt</a></li><li data-type='method'><a href="Part.html#setBus">setBus</a></li><li data-type='method'><a href="Part.html#setConnector">setConnector</a></li><li data-type='method'><a href="Part.html#setProperty">setProperty</a></li><li data-type='method'><a href="Part.html#setSubpart">setSubpart</a></li><li data-type='method'><a href="Part.html#setTag">setTag</a></li><li data-type='method'><a href="Part.html#setViewSettings">setViewSettings</a></li><li data-type='method'><a href="Part.html#toFZP">toFZP</a></li></ul></li><li><a href="PartBin.html">PartBin</a><ul class='methods'><li data-type='method'><a href="PartBin.html#.fromFZB">fromFZB</a></li><li data-type='method'><a href="PartBin.html#.toFZB">toFZB</a></li><li data-type='method'><a href="PartBin.html#getPart">getPart</a></li><li data-type='method'><a href="PartBin.html#hasPart">hasPart</a></li><li data-type='method'><a href="PartBin.html#removePart">removePart</a></li><li data-type='method'><a href="PartBin.html#setPart">setPart</a></li><li data-type='method'><a href="PartBin.html#toFZB">toFZB</a></li></ul></li><li><a href="PartBinBundle.html">PartBinBundle</a><ul class='methods'><li data-type='method'><a href="PartBinBundle.html#.fromFZBZ">fromFZBZ</a></li><li data-type='method'><a href="PartBinBundle.html#.toFZBZ">toFZBZ</a></li><li data-type='method'><a href="PartBinBundle.html#getPartBin">getPartBin</a></li><li data-type='method'><a href="PartBinBundle.html#getPrimary">getPrimary</a></li><li data-type='method'><a href="PartBinBundle.html#hasPartBin">hasPartBin</a></li><li data-type='method'><a href="PartBinBundle.html#hasPrimary">hasPrimary</a></li><li data-type='method'><a href="PartBinBundle.html#removePartBin">removePartBin</a></li><li data-type='method'><a href="PartBinBundle.html#removePrimary">removePrimary</a></li><li data-type='method'><a href="PartBinBundle.html#setPartBin">setPartBin</a></li><li data-type='method'><a href="PartBinBundle.html#setPrimary">setPrimary</a></li><li data-type='method'><a href="PartBinBundle.html#toFZBZ">toFZBZ</a></li><li data-type='method'><a href="PartBinBundle.html#toZip">toZip</a></li></ul></li><li><a href="PartBundle.html">PartBundle</a><ul class='methods'><li data-type='method'><a href="PartBundle.html#.fromFZPZ">fromFZPZ</a></li><li data-type='method'><a href="PartBundle.html#.toFZPZ">toFZPZ</a></li><li data-type='method'><a href="PartBundle.html#getPart">getPart</a></li><li data-type='method'><a href="PartBundle.html#getPrimary">getPrimary</a></li><li data-type='method'><a href="PartBundle.html#hasPart">hasPart</a></li><li data-type='method'><a href="PartBundle.html#hasPrimary">hasPrimary</a></li><li data-type='method'><a href="PartBundle.html#removePart">removePart</a></li><li data-type='method'><a href="PartBundle.html#removePrimary">removePrimary</a></li><li data-type='method'><a href="PartBundle.html#setPart">setPart</a></li><li data-type='method'><a href="PartBundle.html#setPrimary">setPrimary</a></li><li data-type='method'><a href="PartBundle.html#toFZPZ">toFZPZ</a></li><li data-type='method'><a href="PartBundle.html#toZip">toZip</a></li></ul></li><li><a href="PartConnector.html">PartConnector</a><ul class='methods'><li data-type='method'><a href="PartConnector.html#getViewSettings">getViewSettings</a></li><li data-type='method'><a href="PartConnector.html#getViewSettingsAt">getViewSettingsAt</a></li><li data-type='method'><a href="PartConnector.html#hasViewSettings">hasViewSettings</a></li><li data-type='method'><a href="PartConnector.html#removeViewSettings">removeViewSettings</a></li><li data-type='method'><a href="PartConnector.html#removeViewSettingsAt">removeViewSettingsAt</a></li><li data-type='method'><a href="PartConnector.html#setViewSettings">setViewSettings</a></li></ul></li><li><a href="PartConnectorLayerSettings.html">PartConnectorLayerSettings</a></li><li><a href="PartConnectorViewSettings.html">PartConnectorViewSettings</a><ul class='methods'><li data-type='method'><a href="PartConnectorViewSettings.html#getLayerSettings">getLayerSettings</a></li><li data-type='method'><a href="PartConnectorViewSettings.html#getLayerSettingsAt">getLayerSettingsAt</a></li><li data-type='method'><a href="PartConnectorViewSettings.html#hasLayerSettings">hasLayerSettings</a></li><li data-type='method'><a href="PartConnectorViewSettings.html#removeLayerSettings">removeLayerSettings</a></li><li data-type='method'><a href="PartConnectorViewSettings.html#removeLayerSettingsAt">removeLayerSettingsAt</a></li><li data-type='method'><a href="PartConnectorViewSettings.html#setLayerSettings">setLayerSettings</a></li></ul></li><li><a href="PartLayer.html">PartLayer</a></li><li><a href="PartProperty.html">PartProperty</a></li><li><a href="PartViewSettings.html">PartViewSettings</a><ul class='methods'><li data-type='method'><a href="PartViewSettings.html#getLayer">getLayer</a></li><li data-type='method'><a href="PartViewSettings.html#getLayerAt">getLayerAt</a></li><li data-type='method'><a href="PartViewSettings.html#hasLayer">hasLayer</a></li><li data-type='method'><a href="PartViewSettings.html#removeLayer">removeLayer</a></li><li data-type='method'><a href="PartViewSettings.html#removeLayerAt">removeLayerAt</a></li><li data-type='method'><a href="PartViewSettings.html#setLayer">setLayer</a></li></ul></li><li><a href="Point.html">Point</a></li><li><a href="PointBezierPair.html">PointBezierPair</a></li><li><a href="Program.html">Program</a></li><li><a href="Property.html">Property</a></li><li><a href="Sketch.html">Sketch</a><ul class='methods'><li data-type='method'><a href="Sketch.html#.fromFZ">fromFZ</a></li><li data-type='method'><a href="Sketch.html#.toFZ">toFZ</a></li><li data-type='method'><a href="Sketch.html#getBoardAt">getBoardAt</a></li><li data-type='method'><a href="Sketch.html#getInstance">getInstance</a></li><li data-type='method'><a href="Sketch.html#getInstanceAt">getInstanceAt</a></li><li data-type='method'><a href="Sketch.html#getProgramAt">getProgramAt</a></li><li data-type='method'><a href="Sketch.html#getViewSettings">getViewSettings</a></li><li data-type='method'><a href="Sketch.html#getViewSettingsAt">getViewSettingsAt</a></li><li data-type='method'><a href="Sketch.html#hasBoard">hasBoard</a></li><li data-type='method'><a href="Sketch.html#hasInstance">hasInstance</a></li><li data-type='method'><a href="Sketch.html#hasProgram">hasProgram</a></li><li data-type='method'><a href="Sketch.html#hasViewSettings">hasViewSettings</a></li><li data-type='method'><a href="Sketch.html#removeBoard">removeBoard</a></li><li data-type='method'><a href="Sketch.html#removeBoardAt">removeBoardAt</a></li><li data-type='method'><a href="Sketch.html#removeInstance">removeInstance</a></li><li data-type='method'><a href="Sketch.html#removeInstanceAt">removeInstanceAt</a></li><li data-type='method'><a href="Sketch.html#removeProgram">removeProgram</a></li><li data-type='method'><a href="Sketch.html#removeProgramAt">removeProgramAt</a></li><li data-type='method'><a href="Sketch.html#removeViewSettings">removeViewSettings</a></li><li data-type='method'><a href="Sketch.html#removeViewSettingsAt">removeViewSettingsAt</a></li><li data-type='method'><a href="Sketch.html#setBoard">setBoard</a></li><li data-type='method'><a href="Sketch.html#setInstance">setInstance</a></li><li data-type='method'><a href="Sketch.html#setProgram">setProgram</a></li><li data-type='method'><a href="Sketch.html#setViewSettings">setViewSettings</a></li><li data-type='method'><a href="Sketch.html#toFZ">toFZ</a></li></ul></li><li><a href="SketchBundle.html">SketchBundle</a><ul class='methods'><li data-type='method'><a href="SketchBundle.html#.fromFZZ">fromFZZ</a></li><li data-type='method'><a href="SketchBundle.html#.toFZZ">toFZZ</a></li><li data-type='method'><a href="SketchBundle.html#getPrimary">getPrimary</a></li><li data-type='method'><a href="SketchBundle.html#getSketch">getSketch</a></li><li data-type='method'><a href="SketchBundle.html#hasPrimary">hasPrimary</a></li><li data-type='method'><a href="SketchBundle.html#hasSketch">hasSketch</a></li><li data-type='method'><a href="SketchBundle.html#removePrimary">removePrimary</a></li><li data-type='method'><a href="SketchBundle.html#removeSketch">removeSketch</a></li><li data-type='method'><a href="SketchBundle.html#setPrimary">setPrimary</a></li><li data-type='method'><a href="SketchBundle.html#setSketch">setSketch</a></li><li data-type='method'><a href="SketchBundle.html#toFZZ">toFZZ</a></li><li data-type='method'><a href="SketchBundle.html#toZip">toZip</a></li></ul></li><li><a href="SketchPCBViewSettings.html">SketchPCBViewSettings</a></li><li><a href="SketchViewSettings.html">SketchViewSettings</a></li><li><a href="Subpart.html">Subpart</a><ul class='methods'><li data-type='method'><a href="Subpart.html#getConnectorIdAt">getConnectorIdAt</a></li><li data-type='method'><a href="Subpart.html#hasConnectorId">hasConnectorId</a></li><li data-type='method'><a href="Subpart.html#removeConnectorId">removeConnectorId</a></li><li data-type='method'><a href="Subpart.html#removeConnectorIdAt">removeConnectorIdAt</a></li><li data-type='method'><a href="Subpart.html#setConnectorId">setConnectorId</a></li></ul></li><li><a href="TitleGeometry.html">TitleGeometry</a><ul class='methods'><li data-type='method'><a href="TitleGeometry.html#getVisiblePropertyAt">getVisiblePropertyAt</a></li><li data-type='method'><a href="TitleGeometry.html#hasVisibleProperty">hasVisibleProperty</a></li><li data-type='method'><a href="TitleGeometry.html#removeVisibleProperty">removeVisibleProperty</a></li><li data-type='method'><a href="TitleGeometry.html#removeVisiblePropertyAt">removeVisiblePropertyAt</a></li><li data-type='method'><a href="TitleGeometry.html#setVisibleProperty">setVisibleProperty</a></li></ul></li><li><a href="Transform.html">Transform</a></li><li><a href="TransformGeometry.html">TransformGeometry</a></li><li><a href="WireExtras.html">WireExtras</a></li><li><a href="WireGeometry.html">WireGeometry</a></li><li><a href="WireInstanceViewSettings.html">WireInstanceViewSettings</a><ul class='methods'><li data-type='method'><a href="WireInstanceViewSettings.html#getConnector">getConnector</a></li><li data-type='method'><a href="WireInstanceViewSettings.html#getConnectorAt">getConnectorAt</a></li><li data-type='method'><a href="WireInstanceViewSettings.html#hasConnector">hasConnector</a></li><li data-type='method'><a href="WireInstanceViewSettings.html#removeConnector">removeConnector</a></li><li data-type='method'><a href="WireInstanceViewSettings.html#removeConnectorAt">removeConnectorAt</a></li><li data-type='method'><a href="WireInstanceViewSettings.html#setConnector">setConnector</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#Current">Current</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">bundle.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * GNU GPLv3.0
 *
 *  This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see &lt;https://www.gnu.org/licenses/>.
 *
 * @author Max Karpawich
 * Based on work by Paul Vollmer
 */

'use strict'

var ADMZip = require('adm-zip')
var { Part } = require('./part')
var { Sketch } = require('./sketch')
var { PartBin } = require('./bin')

/**
 * @constructor
 * @class
 * @classdesc A collection of "primary" Fritzing data and "auxiliary" resource files
 * @param {{fileName: string, model: object}} [primary = {}] A collection of Fritzing data referenced by file name
 * @param {{fileName: string, fileContents: string}} [auxiliary = {}] A collection of resource files referenced by file name
 * @param {function} toFile Converts a Fritzing JavaScript model to its corresponding data file
 * @param {function} fromFile Converts a data file to its corresponding Fritzing JavaScript model, returning a Promise that will resolve to the generated model
 * @param {function} isPrimary Returns whether or not a given file is classified as Fritzing data using file extensions
 */
var Bundle = function (primary, auxiliary, toFile, fromFile, isPrimary) {
  this.primary = primary || {}
  this.auxiliary = auxiliary || {}
  this.toFile = toFile
  this.fromFile = fromFile
  this.isPrimary = isPrimary
}

/**
 * Returns the primary with the given file name
 * @param {string} fileName The file name of the primary
 * @return {object} The primary with the given file name
 */
Bundle.prototype.getPrimary = function (fileName) {
  return this.primary[fileName]
}

/**
 * Adds a primary to this Bundle on the condition that another primary with the same file name does not already exist
 * @param {string} fileName The file name of the primary to be added
 * @param {object} primary The primary to be added
 */
Bundle.prototype.setPrimary = function (fileName, primary) {
  this.primary[fileName] = primary
}

/**
 * Returns whether this Bundle has a primary with the given file name
 * @param {string} fileName The given file name to search for
 * @return {boolean} Whether this Bundle has a primary with the given file name
 */
Bundle.prototype.hasPrimary = function (fileName) {
  return this.primary.hasOwnProperty(fileName)
}

/**
 * Removes the primary with the given file name
 * @param {string} fileName The file name of the primary
 */
Bundle.prototype.removePrimary = function (fileName) {
  delete this.primary[fileName]
}

/**
 * Returns this Bundle as a zip file buffer
 * @return {Buffer} This Bundle as a zip file buffer
 */
Bundle.prototype.toZip = function () {
  var i
  var primary = this.primary
  var auxiliary = this.auxiliary
  var primaryFiles = Object.keys(primary)
  var auxiliaryFiles = Object.keys(auxiliary)
  var zip = new ADMZip()

  for (i = 0; i &lt; primaryFiles.length; i++) {
    var primaryFile = primaryFiles[i]
    zip.addFile(primaryFile, Buffer.from(this.toFile(primary[primaryFile])))
  }

  for (i = 0; i &lt; auxiliaryFiles.length; i++) {
    var auxiliaryFile = auxiliaryFiles[i]
    zip.addFile(auxiliaryFile, Buffer.from(auxiliary[auxiliaryFile]))
  }

  return zip.toBuffer()
}

/**
 * @static
 * Returns the given Bundle as a zip file buffer
 * @param {PartBin} bundle The given Bundle
 * @return {Buffer} The given Bundle as a zip file buffer
 */
Bundle.toZip = function (bundle) {
  return bundle.toZip()
}

/**
 * @static
 * Returns a Promise that resolves with a {@link Bundle} object converted from the given zip file buffer
 * @param {Buffer} zip A zip file buffer
 * @return {Promise} A Promise that resolves with a {@link Bundle} object converted from the given zip file buffer
 */
Bundle.fromZip = function (zip) {
  return new Promise(function (resolve, reject) {
    var unzipped = new ADMZip(zip)
    var entries = unzipped.getEntries()
    var primary = {}
    var auxiliary = {}
    var promises = []
    for (var i = 0; i &lt; entries.length; i++) {
      promises.push(new Promise(function (resolve, reject) {
        var entry = entries[i]
        var entryName = entry.entryName
        if (this.isPrimary(entryName)) {
          var data = entry.getData()
          if (data.length > 0) {
            this.fromFile(data)
              .then(function (primaryObject) {
                primary[entryName] = primaryObject
                resolve()
              })
              .catch(function (err) {
                reject(err)
              })
          } else {
            reject(new Error('There was an error while reading "' + entryName + '" from the bundle file.'))
          }
        } else {
          unzipped.readAsTextAsync(entry, function (data) {
            if (data !== '') {
              auxiliary[entryName] = data
              resolve()
            } else {
              reject(new Error('There was an error while reading "' + entryName + '" from the bundle file.'))
            }
          })
        }
      }))
    }

    Promise.all(promises)
      .then(function () {
        resolve(new this(primary, auxiliary))
      })
      .catch(function (err) {
        reject(err)
      })
  })
}

/**
 * @constructor
 * @class
 * @extends Bundle
 * @classdesc A {@link Bundle} of {@link Sketch}es and their auxiliary files
 * @param {{fileName: string, model: Sketch}} primary A collection of {@link Sketch}es
 * @param {{fileName: string, fileContents: string}} auxiliary A collection of auxiliary files for {@link Sketch}es
 */
var SketchBundle = function (primary, auxiliary) {
  Bundle.call(this, primary, auxiliary)

  this.toFile = function (sketch) {
    return sketch.toFZ()
  }
}

SketchBundle.prototype = Object.create(Bundle.prototype)
SketchBundle.prototype.constructor = SketchBundle

/**
 * Returns the {@link Sketch} with the given file name
 * @param {string} fileName The file name of the {@link Sketch}
 * @return {Sketch} The {@link Sketch} with the given file name
 */
SketchBundle.prototype.getSketch = function (fileName) {
  return this.getPrimary(fileName)
}

/**
 * Adds a {@link Sketch} to this SketchBundle on the condition that another {@link Sketch} with the same file name does not already exist
 * @param {string} fileName The file name of the {@link Sketch} to be added
 * @param {Sketch} sketch The {@link Sketch} to be added
 */
SketchBundle.prototype.setSketch = function (fileName, sketch) {
  this.setPrimary(fileName, sketch)
}

/**
 * Returns whether this SketchBundle has a {@link Sketch} with the given file name
 * @param {string} fileName The given file name to search for
 * @return {boolean} Whether this SketchBundle has a {@link Sketch} with the given file name
 */
SketchBundle.prototype.hasSketch = function (fileName) {
  return this.hasPrimary(fileName)
}

/**
 * Removes the {@link Sketch} with the given file name
 * @param {string} fileName The file name of the {@link Sketch}
 */
SketchBundle.prototype.removeSketch = function (fileName) {
  this.removePrimary(fileName)
}

SketchBundle.fromFile = function (data) {
  return Sketch.fromFZ(data.toString())
}

SketchBundle.isPrimary = function (entryName) {
  return entryName.endsWith('.fz')
}

/**
 * Returns this SketchBundle as a zip file buffer
 */
SketchBundle.prototype.toFZZ = function () {
  return this.toZip()
}

/**
 * @static
 * Returns the given SketchBundle as a zip file buffer
 * @param {SketchBundle} sketchBundle The given SketchBundle
 */
SketchBundle.toFZZ = function (sketchBundle) {
  return sketchBundle.toFZZ()
}

/**
 * @static
 * Returns a Promise that resolves with a {@link SketchBundle} object converted from the given zip file buffer
 * @param {Buffer} fzz A FZZ zip file buffer
 */
SketchBundle.fromFZZ = function (fzz) {
  return Bundle.fromZip(fzz)
}

/**
 * @constructor
 * @class
 * @extends Bundle
 * @classdesc A {@link Bundle} of {@link Part}s and their auxiliary files
 * @param {{fileName: string, model: Part}} primary A collection of {@link Part}s
 * @param {{fileName: string, fileContents: string}} auxiliary A collection of auxiliary files for {@link Part}s
 */
var PartBundle = function (primary, auxiliary) {
  Bundle.call(this, primary, auxiliary)

  this.toFile = function (part) {
    return part.toFZP()
  }
}

PartBundle.prototype = Object.create(Bundle.prototype)
PartBundle.prototype.constructor = PartBundle

/**
 * Returns the {@link Part} with the given file name
 * @param {string} fileName The file name of the {@link Part}
 * @return {Part} The {@link Part} with the given file name
 */
PartBundle.prototype.getPart = function (fileName) {
  return this.getPrimary(fileName)
}

/**
 * Adds a {@link Part} to this PartBundle on the condition that another {@link Part} with the same file name does not already exist
 * @param {string} fileName The file name of the {@link Part} to be added
 * @param {Part} part The {@link Part} to be added
 */
PartBundle.prototype.setPart = function (fileName, part) {
  this.setPrimary(fileName, part)
}

/**
 * Returns whether this PartBundle has a {@link Part} with the given file name
 * @param {string} fileName The given file name to search for
 * @return {boolean} Whether this PartBundle has a {@link Part} with the given file name
 */
PartBundle.prototype.hasPart = function (fileName) {
  return this.hasPrimary(fileName)
}

/**
 * Removes the {@link Part} with the given file name
 * @param {string} fileName The file name of the {@link Part}
 */
PartBundle.prototype.removePart = function (fileName) {
  this.removePrimary(fileName)
}

PartBundle.fromFile = function (data) {
  return Part.fromFZP(data.toString())
}

PartBundle.isPrimary = function (entryName) {
  return entryName.endsWith('.fzp')
}

/**
 * Returns this PartBundle as a zip file buffer
 */
PartBundle.prototype.toFZPZ = function () {
  return this.toZip()
}

/**
 * @static
 * Returns the given PartBundle as a zip file buffer
 * @param {PartBundle} partBundle The given PartBundle
 */
PartBundle.toFZPZ = function (partBundle) {
  return partBundle.toFZPZ()
}

/**
 * @static
 * Returns a Promise that resolves with a {@link PartBundle} object converted from the given zip file buffer
 * @param {Buffer} fzpz A FZP zip file buffer
 */
PartBundle.fromFZPZ = function (fzpz) {
  return Bundle.fromZip(fzpz)
}

/**
 * @constructor
 * @class
 * @extends Bundle
 * @classdesc A {@link Bundle} of {@link PartBin}s and their auxiliary files
 * @param {{fileName: string, model: PartBinBundle}} primary A collection of {@link PartBin}s
 * @param {{fileName: string, fileContents: string}} auxiliary A collection of auxiliary files for {@link PartBin}s
 */
var PartBinBundle = function (primary, auxiliary) {
  Bundle.call(this, primary, auxiliary)

  this.toFile = function (bin) {
    return bin.toFZB()
  }
}

PartBinBundle.prototype = Object.create(Bundle.prototype)
PartBinBundle.prototype.constructor = PartBinBundle

/**
 * Returns the {@link PartBin} with the given file name
 * @param {string} fileName The file name of the {@link PartBin}
 * @return {PartBin} The {@link PartBin} with the given file name
 */
PartBinBundle.prototype.getPartBin = function (fileName) {
  return this.getPrimary(fileName)
}

/**
 * Adds a {@link PartBin} to this PartBinBundle on the condition that another {@link PartBin} with the same file name does not already exist
 * @param {string} fileName The file name of the {@link PartBin} to be added
 * @param {PartBin} bin The {@link PartBin} to be added
 */
PartBinBundle.prototype.setPartBin = function (fileName, bin) {
  this.setPrimary(fileName, bin)
}

/**
 * Returns whether this PartBinBundle has a {@link PartBin} with the given file name
 * @param {string} fileName The given file name to search for
 * @return {boolean} Whether this PartBinBundle has a {@link PartBin} with the given file name
 */
PartBinBundle.prototype.hasPartBin = function (fileName) {
  return this.hasPrimary(fileName)
}

/**
 * Removes the {@link PartBin} with the given file name
 * @param {string} fileName The file name of the {@link PartBin}
 */
PartBinBundle.prototype.removePartBin = function (fileName) {
  this.removePrimary(fileName)
}

PartBinBundle.fromFile = function (data) {
  return PartBin.fromFZB(data.toString())
}

PartBinBundle.isPrimary = function (entryName) {
  return entryName.endsWith('.fzb')
}

/**
 * Returns this PartBinBundle as a zip file buffer
 */
PartBinBundle.prototype.toFZBZ = function () {
  return this.toZip()
}

/**
 * @static
 * Returns the given PartBinBundle as a zip file buffer
 * @param {PartBinBundle} partBinBundle The given PartBinBundle
 */
PartBinBundle.toFZBZ = function (partBinBundle) {
  return partBinBundle.toFZBZ()
}

/**
 * @static
 * Returns a Promise that resolves with a {@link PartBinBundle} object converted from the given zip file buffer
 * @param {Buffer} fzbz A FZBZ zip file buffer
 */
PartBinBundle.fromFZBZ = function (fzbz) {
  return Bundle.fromZip(fzbz)
}

module.exports = {
  Bundle: Bundle,
  SketchBundle: SketchBundle,
  PartBundle: PartBundle,
  PartBinBundle: PartBinBundle
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Feb 12 2019 19:57:06 GMT-0500 (Eastern Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>
